backported some fixes 2